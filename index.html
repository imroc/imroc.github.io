<!DOCTYPE html><html lang="zh-Hans" >

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  
  
  <meta name="generator" content="Wowchemy 5.0.0-beta.1 for Hugo">
  

  

  
  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="roc">

  
  
  
    
  
  <meta name="description" content="云原生 | 容器 | Kubernetes | Service Mesh | Istio">

  
  <link rel="alternate" hreflang="en" href="/en/">
  
  <link rel="alternate" hreflang="zh-Hans" href="/">

  







  




  
  
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  

  
  
  
  <meta name="theme-color" content="#1565c0">
  

  
  

  
  
  
  
    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous" media="print" onload="this.media='all'">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
        
      
    

    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.2.2/lazysizes.min.js" integrity="sha512-TmDwFLhg3UA4ZG0Eb4MIyT1O1Mb+Oww5kFG0uHqXsdbyZz9DcvYQhKpGgNkamAI6h2lGGZq2X8ftOJvF/XjTUg==" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      
        
      

      
    
      

      
      

      
    
      

      
      

      
    

  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.a2dda909fb8228e17412d06b4423e0a6.css">

  




  

  


  
  

  
  <link rel="alternate" href="/index.xml" type="application/rss+xml" title="roc的个人网站">
  

  
  <link rel="manifest" href="/index.webmanifest">
  

  <link rel="icon" type="image/png" href="/images/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_32x32_fill_lanczos_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_192x192_fill_lanczos_center_2.png">

  <link rel="canonical" href="/">

  
  
  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="twitter:site" content="@imrocchan">
  <meta property="twitter:creator" content="@imrocchan">
  
  <meta property="og:site_name" content="roc的个人网站">
  <meta property="og:url" content="/">
  <meta property="og:title" content="roc的个人网站">
  <meta property="og:description" content="云原生 | 容器 | Kubernetes | Service Mesh | Istio"><meta property="og:image" content="/images/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_512x512_fill_lanczos_center_2.png">
  <meta property="twitter:image" content="/images/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_512x512_fill_lanczos_center_2.png"><meta property="og:locale" content="zh-Hans">
  
    <meta property="og:updated_time" content="2020-11-25T00:00:00&#43;00:00">
  

  

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "potentialAction": {
    "@type": "SearchAction",
    "target": "/?q={search_term_string}",
    "query-input": "required name=search_term_string"
  },
  "url": "/"
}
</script>


  


  


  





  <title>roc的个人网站</title>

</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper  ">

  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.7264cf0eba3b66951b36da7d2cecf9c5.js"></script>

  

<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>搜索</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="搜索..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="搜索...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    












<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container-xl">

    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="切换导航">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-center" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        

        

        
        
        
        

        
          
        

        <li class="nav-item">
          <a class="nav-link " href="/"><span>主页</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/post/"><span>技术博客</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#notes" data-target="#notes"><span>学习笔记</span></a>
        </li>

        
        

        

        
        
        
          
        

        

        
        
        
        

        
          
            
            
          
          
            
            
            
              
            
            
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#tags" data-target="#tags"><span>内容标签</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

      
      
        
      

      
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#" aria-label="搜索"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      
      
      <li class="nav-item dropdown theme-dropdown">
        <a href="#" class="nav-link" data-toggle="dropdown" aria-haspopup="true" aria-label="Display preferences">
          <i class="fas fa-moon" aria-hidden="true"></i>
        </a>
        <div class="dropdown-menu">
          <a href="#" class="dropdown-item js-set-theme-light">
            <span>浅色</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-dark">
            <span>深色</span>
          </a>
          <a href="#" class="dropdown-item js-set-theme-auto">
            <span>自动</span>
          </a>
        </div>
      </li>
      

      
      <li class="nav-item dropdown i18n-dropdown">
        <a href="#" class="nav-link " data-toggle="dropdown"
           aria-haspopup="true" aria-label="Languages">
          <i class="fas fa-globe mr-1" aria-hidden="true"></i></a>
        <div class="dropdown-menu">
          <div class="dropdown-item dropdown-item-active">
            <span>中文 (简体)</span>
          </div>
          
          <a class="dropdown-item" href="/en/" data-target="/en/">
            <span>English</span>
          </a>
          
        </div>
      </li>
      

    </ul>

  </div>
</nav>


  </div>

  <div class="page-body">
    









  
<span class="js-widget-page d-none"></span>





  
  
  
  




  
  
  
  

  

  

  

  

  

  
  

  

  
  

  
  
  

  
  
  
  
  

  
  

  

  
  

  
  

  
  <section id="about" class="home-section wg-about  "  >
   <div class="home-section-bg " ></div>
    <div class="container">

    

      




  










<div class="row">
  <div class="col-12 col-lg-4">
    <div id="profile">

      
      
      <img class="avatar avatar-circle" src="/author/roc/avatar_hu49c03114a9ce8ad2bc0bd62c0ddb3f2a_64404_270x270_fill_q75_lanczos_center.jpg" alt="roc">
      

      <div class="portrait-title">
        <h2>roc</h2>
        <h3>产品架构师</h3>

        
        <h3>
          <a href="https://www.tencent.com/" target="_blank" rel="noopener">
          <span>Tencent</span>
          </a>
        </h3>
        
      </div>

      <ul class="network-icon" aria-hidden="true">
        
        
        
        
          
        
        
        
        
        
          
        
        <li>
          <a href="https://github.com/imroc" target="_blank" rel="noopener" aria-label="github">
            <i class="fab fa-github big-icon"></i>
          </a>
        </li>
        
        
        
        
          
        
        
        
        
        
        <li>
          <a href="mailto:roc@imroc.io"  aria-label="envelope">
            <i class="fas fa-envelope big-icon"></i>
          </a>
        </li>
        
        
        
        
          
        
        
        
        
        
          
        
        <li>
          <a href="https://twitter.com/imrocchan" target="_blank" rel="noopener" aria-label="twitter">
            <i class="fab fa-twitter big-icon"></i>
          </a>
        </li>
        
        
        
        
          
        
        
        
        
        
          
        
        <li>
          <a href="https://www.linkedin.com/in/%E9%B9%8F-%E9%99%88-b51646113" target="_blank" rel="noopener" aria-label="linkedin">
            <i class="fab fa-linkedin big-icon"></i>
          </a>
        </li>
        
        
        
        
          
        
        
        
        
        
          
        
        <li>
          <a href="https://www.youtube.com/channel/UCEtWQhtiNi1vvDmoC6wydNQ" target="_blank" rel="noopener" aria-label="youtube">
            <i class="fab fa-youtube big-icon"></i>
          </a>
        </li>
        
      </ul>

    </div>
  </div>
  <div class="col-12 col-lg-8">

    
    <h1>关于</h1>

    <div class="article-style">
      <p>Hi，我是 roc，专注云原生技术领域，目前就职于腾讯云，我将不定期分享容器、Kubernetes、Service Mesh 等相关干货，感兴趣的同学可以关注我的学习笔记与博客，另外还有公众号 <strong>云原生知识宇宙</strong>。</p>
<p>（欢迎使用 <a href="/index.xml">RSS订阅</a> 本站内容更新）</p>
<p><strong>本站正在大力重构过程中，目前使用 Github Pages 托管，国内访问比较慢，后续抽时间将会迁移。</strong></p>

    </div>

    <div class="row">

      

      

    </div>
  </div>
</div>


    

    </div>
  </section>

  
  
  
  

  

  

  

  

  

  
  

  

  
  

  
  
  

  
  
  
  
  

  
  

  

  
  

  
  

  
  <section id="notes" class="home-section wg-portfolio  "  >
   <div class="home-section-bg " ></div>
    <div class="container">

    
      <div class="row  justify-content-center">
      
        
          <div class="col-12 section-heading text-center">
            <h1>学习笔记</h1>
            
          </div>
        
      
    

      









<div class="col-12 ">

  

  

    

    
    
    
    
      
    

    <span class="d-none default-project-filter">*</span>

    
    
    <div class="project-toolbar">
      <div class="project-filters">
        <div class="btn-toolbar">
          <div class="btn-group flex-wrap">
            
              
              
              
                
              
              <a href="#" data-filter="*" class="btn btn-primary btn-lg active">全部</a>
            
              
              
              
              <a href="#" data-filter=".js-id-工具" class="btn btn-primary btn-lg">工具</a>
            
              
              
              
              <a href="#" data-filter=".js-id-云原生" class="btn btn-primary btn-lg">云原生</a>
            
              
              
              
              <a href="#" data-filter=".js-id-容器" class="btn btn-primary btn-lg">容器</a>
            
              
              
              
              <a href="#" data-filter=".js-id-ServiceMesh" class="btn btn-primary btn-lg">ServiceMesh</a>
            
          </div>
        </div>
      </div>
    </div>
    
  

  <div class="isotope projects-container js-layout-masonry ">

    
    
      
    

    

      
      
      
        
        
      

      
        








  





<div class="project-card project-item isotope-item js-id-云原生">
  <div class="card">
    
    
    
    
    <a href="https://imroc.io/learning-kubernetes/" target="_blank" rel="noopener" class="card-image hover-overlay">
      <img src="/note/learning-kubernetes/featured_hud283d4a96c99f38a40286bda5c731bb6_12196_8c0ca728682c2f649ca79148babf25a6.jpg" data-src="/note/learning-kubernetes/featured_hud283d4a96c99f38a40286bda5c731bb6_12196_550x0_resize_q75_lanczos.jpg" alt="Kubernetes 学习笔记" class="img-responsive lazyload">
    </a>
    
    <div class="card-text">
      <h4><a href="https://imroc.io/learning-kubernetes/" target="_blank" rel="noopener">Kubernetes 学习笔记</a></h4>

      
      <div class="article-style">
        <p>一起学习 k8s</p>
      </div>
      

      
      <div class="btn-links">
        








  


















  
  
  
    
  
  
  
  
  
    
  
  <a class="btn btn-outline-primary btn-page-header btn-sm" href="https://github.com/imroc/learning-kubernetes" target="_blank" rel="noopener">
    <i class="fab fa-github mr-1"></i>
    Star
  </a>


      </div>
      
    </div>
  </div>
</div>

      

    

      
      
      
        
        
      

      
        








  





<div class="project-card project-item isotope-item js-id-云原生">
  <div class="card">
    
    
    
    
    <a href="https://imroc.io/learning-tke/" target="_blank" rel="noopener" class="card-image hover-overlay">
      <img src="/note/learning-tke/featured_hu1b0d7710192e26b0b629bda6fc664d0e_16004_39e374ea9171d19da3b0cbc58dc3dcb5.jpg" data-src="/note/learning-tke/featured_hu1b0d7710192e26b0b629bda6fc664d0e_16004_550x0_resize_q75_lanczos.jpg" alt="TKE 学习笔记" class="img-responsive lazyload">
    </a>
    
    <div class="card-text">
      <h4><a href="https://imroc.io/learning-tke/" target="_blank" rel="noopener">TKE 学习笔记</a></h4>

      
      <div class="article-style">
        <p>分享腾讯云容器服务相关知识与实践经验</p>
      </div>
      

      
      <div class="btn-links">
        








  


















  
  
  
    
  
  
  
  
  
    
  
  <a class="btn btn-outline-primary btn-page-header btn-sm" href="https://github.com/imroc/learning-tke" target="_blank" rel="noopener">
    <i class="fab fa-github mr-1"></i>
    Star
  </a>


      </div>
      
    </div>
  </div>
</div>

      

    

      
      
      
        
        
      

      
        








  





<div class="project-card project-item isotope-item js-id-工具">
  <div class="card">
    
    
    
    
    <a href="https://imroc.io/learning-hugo/" target="_blank" rel="noopener" class="card-image hover-overlay">
      <img src="/note/learning-hugo/featured_hu46ece973efac10d72b76d0f4aa211125_12067_3126a447c752614de1645c7b6f8bae1b.jpg" data-src="/note/learning-hugo/featured_hu46ece973efac10d72b76d0f4aa211125_12067_550x0_resize_q75_lanczos.jpg" alt="Hugo 学习笔记" class="img-responsive lazyload">
    </a>
    
    <div class="card-text">
      <h4><a href="https://imroc.io/learning-hugo/" target="_blank" rel="noopener">Hugo 学习笔记</a></h4>

      
      <div class="article-style">
        <p>分享 hugo 经验</p>
      </div>
      

      
      <div class="btn-links">
        








  


















  
  
  
    
  
  
  
  
  
    
  
  <a class="btn btn-outline-primary btn-page-header btn-sm" href="https://github.com/imroc/learning-hugo" target="_blank" rel="noopener">
    <i class="fab fa-github mr-1"></i>
    Star
  </a>


      </div>
      
    </div>
  </div>
</div>

      

    

      
      
      
        
        
      

      
        








  





<div class="project-card project-item isotope-item js-id-容器">
  <div class="card">
    
    
    
    
    <a href="https://imroc.io/learning-docker/" target="_blank" rel="noopener" class="card-image hover-overlay">
      <img src="/note/learning-docker/featured_hu80e0beb8980d7029da4518f96731b295_12604_2020b3c794a8bc585437a34ac9afe2fb.jpg" data-src="/note/learning-docker/featured_hu80e0beb8980d7029da4518f96731b295_12604_550x0_resize_q75_lanczos.jpg" alt="Docker 学习笔记" class="img-responsive lazyload">
    </a>
    
    <div class="card-text">
      <h4><a href="https://imroc.io/learning-docker/" target="_blank" rel="noopener">Docker 学习笔记</a></h4>

      
      <div class="article-style">
        <p>分享 Docker 相关知识与实践经验</p>
      </div>
      

      
      <div class="btn-links">
        








  


















  
  
  
    
  
  
  
  
  
    
  
  <a class="btn btn-outline-primary btn-page-header btn-sm" href="https://github.com/imroc/learning-docker" target="_blank" rel="noopener">
    <i class="fab fa-github mr-1"></i>
    Star
  </a>


      </div>
      
    </div>
  </div>
</div>

      

    

      
      
      
        
        
      

      
        








  





<div class="project-card project-item isotope-item js-id-云原生 js-id-ServiceMesh">
  <div class="card">
    
    
    
    
    <a href="https://imroc.io/learning-istio/" target="_blank" rel="noopener" class="card-image hover-overlay">
      <img src="/note/learning-istio/featured_hu30b4854c1c9ba94273090594f3b7c6cd_6977_af061df2ef9f61bf59ada7b69fa1bec5.jpg" data-src="/note/learning-istio/featured_hu30b4854c1c9ba94273090594f3b7c6cd_6977_550x0_resize_q75_lanczos.jpg" alt="Istio 学习笔记" class="img-responsive lazyload">
    </a>
    
    <div class="card-text">
      <h4><a href="https://imroc.io/learning-istio/" target="_blank" rel="noopener">Istio 学习笔记</a></h4>

      
      <div class="article-style">
        <p>分享 Istio 相关知识与实践经验</p>
      </div>
      

      
      <div class="btn-links">
        








  


















  
  
  
    
  
  
  
  
  
    
  
  <a class="btn btn-outline-primary btn-page-header btn-sm" href="https://github.com/imroc/learning-istio" target="_blank" rel="noopener">
    <i class="fab fa-github mr-1"></i>
    Star
  </a>


      </div>
      
    </div>
  </div>
</div>

      

    
  </div>
</div>


    
      </div>
    

    </div>
  </section>

  
  
  
  

  

  

  

  

  

  
  

  

  
  

  
  
  

  
  
  
  
  

  
  

  

  
  

  
  

  
  <section id="posts" class="home-section wg-pages  "  >
   <div class="home-section-bg " ></div>
    <div class="container">

    
      <div class="row  ">
      
        
          <div class="col-12 col-lg-4 section-heading">
            <h1>技术博客</h1>
            
          </div>
        
      
    

      








  
























  





  




<div class="col-12 col-lg-8">

  

  
    
      













  


<div class="media stream-item">
  <div class="media-body">

    <div class="section-subheading article-title mb-0 mt-0">
      <a href="/post/202011/build-cloud-native-large-scale-distributed-monitoring-system-4/" >打造云原生大型分布式监控系统(四): Kvass&#43;Thanos 监控超大规模容器集群</a>
    </div>

    
    <a href="/post/202011/build-cloud-native-large-scale-distributed-monitoring-system-4/"  class="summary-link">
      <div class="article-style">
        目录  概述 有 Thanos 不够吗 ? 什么是 Kvass ? 部署实践  部署准备 部署 Kvass 部署 thanos-query   小结    概述 继上一篇 Thanos 部署与实践 发布半年多之后，随着技术的发展，本系列又迎来了一次更新。本文将介绍如何结合 Kvass 与 Thanos，来更好的实现大规模容器集群场景下的监控。
      </div>
    </a>
    

    <div class="stream-meta article-metadata">

      

      
        


<div class="article-metadata">

  
  
  
  
  <div>
    

  <span class="author-highlighted">
      roc</span>
  </div>
  
  

  
  <span class="article-date">
    
    
      
    
    Nov 25, 2020
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    2 分钟阅读时长
  </span>
  

  
  
  
  
  

  
  

</div>

      
    </div>

    

  </div>
  <div class="ml-3">
    
    
  </div>
</div>

    
  
    
      













  


<div class="media stream-item">
  <div class="media-body">

    <div class="section-subheading article-title mb-0 mt-0">
      <a href="/post/202009/nginx-ingress-high-concurrency/" >Nginx Ingress 高并发实践</a>
    </div>

    
    <a href="/post/202009/nginx-ingress-high-concurrency/"  class="summary-link">
      <div class="article-style">
        目录  概述 内核参数调优  调大连接队列的大小 扩大源端口范围 TIME_WAIT 复用 调大最大文件句柄数 配置示例   全局配置调优  调高 keepalive 连接最大请求数 调高 keepalive 最大空闲连接数 调高单个 worker 最大连接数 配置示例   总结 参考资料    概述 Nginx Ingress Controller 基于 Nginx 实现了 Kubernetes Ingress API，Nginx 是公认的高性能网关，但如果不对其进行一些参数调优，就不能充分发挥出高性能的优势。之前我们在 Nginx Ingress on TKE 部署最佳实践 一文中讲了 Nginx Ingress 在 TKE 上部署最佳实践，涉及的部署 YAML 其实已经包含了一些性能方面的参数优化，只是没有提及，本文将继续展开介绍针对 Nginx Ingress 的一些全局配置与内核参数调优的建议，可用于支撑我们的高并发业务。
      </div>
    </a>
    

    <div class="stream-meta article-metadata">

      

      
        


<div class="article-metadata">

  
  
  
  
  <div>
    

  <span class="author-highlighted">
      roc</span>
  </div>
  
  

  
  <span class="article-date">
    
    
      
    
    Sep 2, 2020
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    3 分钟阅读时长
  </span>
  

  
  
  
  
  

  
  

</div>

      
    </div>

    

  </div>
  <div class="ml-3">
    
    
  </div>
</div>

    
  
    
      













  


<div class="media stream-item">
  <div class="media-body">

    <div class="section-subheading article-title mb-0 mt-0">
      <a href="/post/202008/nginx-ingress-on-tke/" >Nginx Ingress on TKE 部署最佳实践</a>
    </div>

    
    <a href="/post/202008/nginx-ingress-on-tke/"  class="summary-link">
      <div class="article-style">
        目录  概述 什么是 Nginx Ingress ? 有哪些部署方案 ?  方案一： Deployment + LB 方案二：Daemonset + HostNetwork + LB 方案三：Deployment + LB 直通 Pod   如何选型？ 如何支持内网 Ingress ? 如何复用已有 LB ?
      </div>
    </a>
    

    <div class="stream-meta article-metadata">

      

      
        


<div class="article-metadata">

  
  
  
  
  <div>
    

  <span class="author-highlighted">
      roc</span>
  </div>
  
  

  
  <span class="article-date">
    
    
      
    
    Aug 7, 2020
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    4 分钟阅读时长
  </span>
  

  
  
  
  
  

  
  

</div>

      
    </div>

    

  </div>
  <div class="ml-3">
    
    
  </div>
</div>

    
  
    
      













  


<div class="media stream-item">
  <div class="media-body">

    <div class="section-subheading article-title mb-0 mt-0">
      <a href="/post/202006/kubernetes-app-deployment-best-practice-2/" >Kubernetes 服务部署最佳实践(二) 如何提高服务可用性</a>
    </div>

    
    <a href="/post/202006/kubernetes-app-deployment-best-practice-2/"  class="summary-link">
      <div class="article-style">
        目录  引言 如何避免单点故障？ 如何避免节点维护或升级时导致服务不可用？ 如何让服务进行平滑更新？ 健康检查怎么配才好？ 参考资料    引言 上一篇 文章我们围绕如何合理利用资源的主题做了一些最佳实践的分享，这一次我们就如何提高服务可用性的主题来展开探讨。
怎样提高我们部署服务的可用性呢？K8S 设计本身就考虑到了各种故障的可能性，并提供了一些自愈机制以提高系统的容错性，但有些情况还是可能导致较长时间不可用，拉低服务可用性的指标。本文将结合生产实践经验，为大家提供一些最佳实践来最大化的提高服务可用性。
如何避免单点故障？ K8S 的设计就是假设节点是不可靠的。节点越多，发生软硬件故障导致节点不可用的几率就越高，所以我们通常需要给服务部署多个副本，根据实际情况调整 replicas 的值，如果值为 1 就必然存在单点故障，如果大于 1 但所有副本都调度到同一个节点了，那还是有单点故障，有时候还要考虑到灾难，比如整个机房不可用。
所以我们不仅要有合理的副本数量，还需要让这些不同副本调度到不同的拓扑域(节点、可用区)，打散调度以避免单点故障，这个可以利用 Pod 反亲和性来做到，反亲和主要分强反亲和与弱反亲和两种。
先来看个强反亲和的示例，将 dns 服务强制打散调度到不同节点上:
      </div>
    </a>
    

    <div class="stream-meta article-metadata">

      

      
        


<div class="article-metadata">

  
  
  
  
  <div>
    

  <span class="author-highlighted">
      roc</span>
  </div>
  
  

  
  <span class="article-date">
    
    
      
    
    Jun 19, 2020
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    2 分钟阅读时长
  </span>
  

  
  
  
  
  

  
  

</div>

      
    </div>

    

  </div>
  <div class="ml-3">
    
    
  </div>
</div>

    
  
    
      













  


<div class="media stream-item">
  <div class="media-body">

    <div class="section-subheading article-title mb-0 mt-0">
      <a href="/post/202006/kubernetes-app-deployment-best-practice-1/" >Kubernetes 服务部署最佳实践(一) 如何合理利用资源</a>
    </div>

    
    <a href="/post/202006/kubernetes-app-deployment-best-practice-1/"  class="summary-link">
      <div class="article-style">
        目录  引言 Request 与 Limit 怎么设置才好  所有容器都应该设置 request 老是忘记设置怎么办 重要的线上应用改如何设置 怎样设置才能提高资源利用率 尽量避免使用过大的 request 与 limit 避免测试 namespace 消耗过多资源影响生产业务   如何让资源得到更合理的分配  使用亲和性 使用污点与容忍   弹性伸缩  如何支持流量突发型业务 如何节约成本 无法水平扩容的服务怎么办   参考资料    引言 业务容器化后，如何将其部署在 K8S 上？如果仅仅是将它跑起来，很简单，但如果是上生产，我们有许多地方是需要结合业务场景和部署环境进行方案选型和配置调优的。比如，如何设置容器的 Request 与 Limit、如何让部署的服务做到高可用、如何配置健康检查、如何进行弹性伸缩、如何更好的进行资源调度、如何选择持久化存储、如何对外暴露服务等。
      </div>
    </a>
    

    <div class="stream-meta article-metadata">

      

      
        


<div class="article-metadata">

  
  
  
  
  <div>
    

  <span class="author-highlighted">
      roc</span>
  </div>
  
  

  
  <span class="article-date">
    
    
      
    
    Jun 16, 2020
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    2 分钟阅读时长
  </span>
  

  
  
  
  
  

  
  

</div>

      
    </div>

    

  </div>
  <div class="ml-3">
    
    
  </div>
</div>

    
  

  
  
  

    
    
      
    

    

    <div class="see-all">
      <a href="/post/">
        查看全部文章
        <i class="fas fa-angle-right"></i>
      </a>
    </div>
  

</div>


    
      </div>
    

    </div>
  </section>

  
  
  
  

  

  

  

  

  

  
  

  

  
  

  
  
  

  
  
  
  
  

  
  

  

  
  

  
  

  
  <section id="tags" class="home-section wg-tag-cloud  "  >
   <div class="home-section-bg " ></div>
    <div class="container">

    
      <div class="row  ">
      
        
          <div class="col-12 col-lg-4 section-heading">
            <h1>内容标签</h1>
            
          </div>
        
      
    

      








  








<div class="col-12 col-lg-8">
  

  

    
    
    
    
    
    

    <div class="tag-cloud">
      
        
        
        
        <a href="/tag/geek/" style="font-size:0.7rem">geek</a>
      
        
        
        
        <a href="/tag/kubernetes/" style="font-size:1.9668799592797315rem">kubernetes</a>
      
        
        
        
        <a href="/tag/macos/" style="font-size:0.7rem">macOS</a>
      
        
        
        
        <a href="/tag/network/" style="font-size:1.2273890324068768rem">network</a>
      
        
        
        
        <a href="/tag/prometheus/" style="font-size:1.3654908645055204rem">prometheus</a>
      
        
        
        
        <a href="/tag/servicemesh/" style="font-size:0.7rem">ServiceMesh</a>
      
        
        
        
        <a href="/tag/troubleshooting/" style="font-size:1.2273890324068768rem">troubleshooting</a>
      
        
        
        
        <a href="/tag/%E4%BA%91%E5%8E%9F%E7%94%9F/" style="font-size:1.2273890324068768rem">云原生</a>
      
        
        
        
        <a href="/tag/%E5%AE%B9%E5%99%A8/" style="font-size:0.7rem">容器</a>
      
        
        
        
        <a href="/tag/%E5%B7%A5%E5%85%B7/" style="font-size:0.7rem">工具</a>
      
    </div>
  

</div>


    
      </div>
    

    </div>
  </section>



  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">
  

  <p class="powered-by">
    roc © 2021
  </p>

  
  






  <p class="powered-by">
    
    
    
    Published with
    <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a>  —
    the free, <a href="https://github.com/wowchemy/wowchemy-hugo-modules" target="_blank" rel="noopener">
    open source</a> website builder that empowers creators.
    
  </p>
</footer>

    </div>
    
  </div>

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">引用</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> 复制
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> 下载
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

      
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      

      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js" integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js" integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js"></script>
        
      

    

    
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
        <div class="search-hit-content">
          <div class="search-hit-name">
            <a href="{{relpermalink}}">{{title}}</a>
            <div class="article-metadata search-hit-type">{{type}}</div>
            <p class="search-hit-description">{{snippet}}</p>
          </div>
        </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    
    

    
    
    

    
    

    
    

    
    
      
      
      
      
      
      
      
    

    
    
    
    
    
    
    
    
    
    
      
      
    
    
    <script src="/zh/js/wowchemy.min.64fd16cc68b6a5f25e0156dfff88edff.js"></script>

    






</body>
</html>
