<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title> 利用Hugo和Github Pages免费创建并永久托管网站 - imroc.io|roc的博客|Cloud Native|Kubernetes|Go|Golang</title>
  <meta name="description" content="imroc.io|roc的博客|Cloud Native|Kubernetes|Go|Golang" />
  <meta property="og:title" content="利用Hugo和Github Pages免费创建并永久托管网站" />
  <meta name="twitter:title" content="利用Hugo和Github Pages免费创建并永久托管网站" />
  <meta name="description" content="教你如何免费建立自己的网站">
  <meta property="og:description" content="教你如何免费建立自己的网站">
  <meta name="twitter:description" content="教你如何免费建立自己的网站">
  <meta name="author" content="{Description { .Site.Author.name }}"/>
  <link href='https://imroc.io/favicon.png' rel='icon' type='image/x-icon'/>
  <meta property="og:image" content="https://imroc.io/images/logo.png" />
  <meta name="twitter:image" content="https://imroc.io/images/logo.png" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@imrocchan" />
  <meta name="twitter:creator" content="@imrocchan" />
  <meta property="og:url" content="https://imroc.io/posts/hugo/building-website-for-free-using-hugo-and-github-pages/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="roc" />

  <meta name="generator" content="Hugo 0.31.1" />
  <link rel="canonical" href="https://imroc.io/posts/hugo/building-website-for-free-using-hugo-and-github-pages/" />
  <link rel="alternate" href="https://imroc.io/index.xml" type="application/rss+xml" title="roc">
  <script src="https://cdn.staticfile.org/jquery/1.12.4/jquery.min.js"></script>
  <link rel="stylesheet" href="https://cdn.staticfile.org/KaTeX/0.7.1/katex.min.css" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" crossorigin="anonymous">

  <link rel="stylesheet" href="https://imroc.io/css/main.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  
  <link rel="stylesheet" href="https://imroc.io/static/prism/prism.css" />

  <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?05e1e8b7484a08c51cd0953664168cd7";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>



<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.2/photoswipe.min.css" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.2/default-skin/default-skin.min.css" crossorigin="anonymous" />


<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>


</head>

  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://imroc.io/">roc</a>
    </div>
    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent" href="javascript:void(0)">Categories</a>
              <div class="navlinks-children">
                
                
                  <a href="https://imroc.io/categories/docker">docker</a>
                
                
                  <a href="https://imroc.io/categories/golang">golang</a>
                
                
                  <a href="https://imroc.io/categories/arch">架构</a>
                
              </div>
            </li>
          
        
          
            <li class="navlinks-container">
              <a class="navlinks-parent" href="javascript:void(0)">Books</a>
              <div class="navlinks-children">
                
                
                  <a href="https://imroc.io/kubernetes-the-gradual-way">Kubernetes The Gradual Way</a>
                
              </div>
            </li>
          
        
          
            <li>
              <a title="Tags" href="/tags">Tags</a>
              
              
            </li>
          
        
          
            <li>
              <a title="About" href="/about">About</a>
              
              
            </li>
          
        

        

      </ul>
    </div>

    <div class="avatar-container">
      <div class="avatar-img-border">
        
          <a title="roc" href="https://imroc.io/">
            <img class="avatar-img" src="https://imroc.io/images/logo.png" alt="roc" />
          </a>
        
      </div>
    </div>

  </div>
</nav>

    
  
  
  




  
    <div id="header-big-imgs" data-num-img=1 data-img-src-1="https://imroc.io/static/blog/hugo/hugo-github.png" data-img-desc-1="Hugo &#43; Github Pages"></div>
  

  <header class="header-section has-img">
    
      <div class="intro-header big-img">
        
        
        <div class="container">
          <div class="row">
              <div class="col-lg-12 col-md-12 col-md-offset-0">
                
                <div class="post-heading">
                
                  
                     <h1>利用Hugo和Github Pages免费创建并永久托管网站</h1>
                     
                    <span class="post-meta">
  
  Posted on January 16, 2018
  
  
</span>


                    
                  
                  
              </div>
            </div>
          </div>
        </div>
        <span class="img-desc" style="display: inline;"></span>
      </div>
    
    <div class="intro-header no-img">
      
      <div class="container">
        <div class="row">
          <div class="col-lg-12 col-md-12 col-md-offset-0">
            <div class="posts-heading">
                <h1 align="center">利用Hugo和Github Pages免费创建并永久托管网站</h1>
                
                
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>


    
<div class="container" role="main" itemscope itemtype="http://schema.org/Article">
    <div class="row">
        <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            
            
            
<div>
    <section id="datecount">
        <h4 id="date"> Tue Jan 16, 2018</h4>
    </section>
    <h5 id="wc">2500 Words|Read in about 5 Min</h5>
    <h5 id="tags">Tags: 
        
        <a href="https://imroc.io/tags/hugo/">hugo</a> &nbsp;
    </h5>
</div>

            
            <article role="main" class="blog-post" itemprop="articleBody" id="content">
                

<h2 id="概述">概述</h2>

<p>Hugo可以让你轻松生成静态网站，比如个人博客、API文档、公司主页等，你只需要提供markdown格式的文本，它就能帮你渲染成各种你想要的样式，只需要安装想要的主题，写好对应的markdown内容，就能快速编译出一个静态网站。</p>

<h2 id="安装hugo">安装hugo</h2>

<p>参考官方：<a href="http://gohugo.io/getting-started/installing/">http://gohugo.io/getting-started/installing/</a></p>

<h2 id="创建网站">创建网站</h2>

<p>首先初始化你的网站，假如 mysite 是存放网站相关文件的目录：</p>

<pre><code class="language-sh">hugo new site mysite
</code></pre>

<p>这会在当前路径创建一个 mysite 目录，进入该路径：</p>

<pre><code class="language-sh">cd mysite
</code></pre>

<p>目录如下：</p>

<pre><code class="language-bash"> ▸ archetypes/
 ▸ content/
 ▸ layouts/
 ▸ static/
 ▸ themes/
   config.toml
</code></pre>

<p><code>config.toml</code> 是网站的配置文件，包含一些基本配置和主题特有的配置。<br />
这几个文件夹的作用分别是：</p>

<ul>
<li>archetypes：包括内容类型，在创建新内容时自动生成内容的配置</li>
<li>content：包括网站内容，全部使用markdown格式</li>
<li>layouts：包括了网站的模版，决定内容如何呈现</li>
<li>static：包括了css, js, fonts, media等，决定网站的外观</li>
<li>themes：用于存放主题</li>
</ul>

<p>在创建页面之前需要安装想要的主题，官方有收集一些：<a href="https://themes.gohugo.io/">https://themes.gohugo.io/</a></p>

<p>在这里我用我博客的主题<code>xhugo</code>作示例，下载到themes目录：</p>

<pre><code class="language-bash">git clone https://github.com/imroc/xhugo.git themes/xhugo
</code></pre>

<p>在配置文件<code>config.toml</code>里加一行，配置本网站的主题：</p>

<pre><code class="language-toml">theme = &quot;xhugo&quot;
</code></pre>

<p><strong>注：</strong> <code>config.toml</code> 中配置的主题名字应和主题目录名称一致</p>

<p>新建页面：</p>

<pre><code class="language-bash">hugo new posts/hello.md
</code></pre>

<p>此时会在 <code>content</code> 路径下创建文件，由于参数中还带有 posts 路径，所以最终创建的文件路径是 <code>content/posts/hello.md</code>， 每次创建的文件都根据 <code>archetypes/default.md</code> 生成的，包含一些页面的特定配置，比如标题、分类等，不同的主题还有自己支持的一些配置，需要看主题的说明。</p>

<h2 id="效果预览">效果预览</h2>

<p>写好 mardown 之后可以本地预览：</p>

<pre><code class="language-bash">hugo server
</code></pre>

<p>在浏览器打开 <a href="http://localhost:1313">http://localhost:1313</a> 就能看到效果，并且改内容页面也能实时自动更新。<br />
<strong>注：</strong> markdown 用什么编写就取决于你自己了，我自己有时用vim，有时用 vscode（装 markdown 的插件）</p>

<h2 id="生成静态页面">生成静态页面</h2>

<p>在生成之前先确定你想将此网站发布在哪儿，在 <code>config.toml</code> 里面配置 <code>baseURL</code> 为访问此网站的基本URL路径：</p>

<pre><code class="language-toml">baseURL = &quot;https://imroc.io/&quot;
</code></pre>

<p>然后</p>

<pre><code class="language-bash">hugo
</code></pre>

<p>对，你没看错，直接执行 <code>hugo</code> 就可以了，它编译并生成网站所需的静态页面和文件，输出到当前目录的 <code>public</code> 目录下，当然你也可以改变输出目的地，如：</p>

<pre><code class="language-bash">hugo -d docs
</code></pre>

<p>你可以将生成的目录放到 nginx 或 tomcat 等服务器下对外提供服务，不过这需要自己有服务器，接下来我教大家如何利用 Github Pages 来做到永久免费。</p>

<h2 id="github-pages">Github Pages</h2>

<p>Github Pages 是 Github 推出的一项功能，可以免费托管静态网站，将你的静态文件放在仓库里，然后在仓库的 <code>Settings</code> 里面，翻到下面的 <code>GitHub Pages</code> 部分，可以将此仓库设置为你的静态网站文件的存放仓库。</p>

<p>其实 <code>Github Pages</code> 仓库分为两种。</p>

<ul>
<li>一种是主仓库，它里面存放的文件可以直接映射到你网站的根路径，而且只能有一个仓库名固定为：<code>&lt;github账号名&gt;.github.io</code>，比如我的 github 账号为 <code>imroc</code>,那么我的 <code>Github Pages</code> 主仓库就为 <code>imroc.github.io</code>，这个仓库的名字其实也就是访问你网站的域名。</li>
<li>其它的仓库只能映射到网站的子路径，子路径名称和仓库名一致，比如我新建一个 <code>static</code> 仓库并设置为 <code>Github Pages</code> 仓库，那么我可以通过 <code>imroc.github.io/static/</code> 访问到里面的页面和文件</li>
</ul>

<h2 id="设置-github-pages">设置 Github Pages</h2>

<p>静态文件存放位置有三种：</p>

<ul>
<li>master 分支</li>
<li>master 分支下 docs 目录</li>
<li>gh-pages 分支(前提是这个分支存在才会显示)</li>
</ul>

<p><strong>注：</strong> <code>Github Pages</code> 主仓库除外，必须是 master 分支。</p>

<p>一般都会先新建第一种 <code>Github Pages</code> 主仓库作为网站主要托管，根据你的账号名创建仓库，如: <code>imroc.github.io</code>， 提交静态文件后在仓库的 <code>Settings</code> 里面，翻到下面的 <code>Github Pages</code> 部分，根据自己需要设置 <code>Github Pages</code> 文件存放位置：
<img src="https://imroc.io/static/blog/hugo/github-pages-setting.png" alt="github pages 设置" /></p>

<h3 id="源文件与-编译结果在同一仓库">源文件与编译结果在同一仓库</h3>

<p>如果你想要将你网站的 <code>hugo</code> 源文件和编译后的静态文件目录放在一个仓库，那可以选择 <code>master</code> 下的 <code>docs</code> 目录作为 <code>Github Pages</code> 目录，编译的时候执行：</p>

<pre><code class="language-bash">hugo -d docs
</code></pre>

<p>建议写个脚本，每次更新内容执行下脚本网站就可以更新，如(<code>deploy.sh</code>)：</p>

<pre><code class="language-bash">#! /bin/bash

set -eux 

echo -e &quot;\033[0;32mDeploying updates to GitHub...\033[0m&quot;

msg=&quot;rebuilding site `date`&quot;

if [ $# -eq 1  ]
    then msg=&quot;$1&quot;
fi

# Build the project. 
hugo -d docs

# Add changes to git.
git add .

# Commit changes.

git commit -m &quot;$msg&quot;

# Push source and build repos.
git push origin master
</code></pre>

<p>这样，每次运行：</p>

<pre><code class="language-bash">./deploy.sh
</code></pre>

<p>或</p>

<pre><code class="language-bash">./deploy.sh &quot;本次更新描述&quot;
</code></pre>

<p>就可以更新网站了。</p>

<p>另外，别忘了给脚本可执行权限哦</p>

<pre><code class="language-bash">chmod +x deploy.sh
</code></pre>

<h3 id="源文件与-编译结果在不同仓库">源文件与编译结果在不同仓库</h3>

<p>新建一个仓库存放源文件（此仓库不需要设置 <code>Github Pages</code>)，如 <code>blog</code> 仓库，编译结果放在主仓库里，如 <code>imroc.github.io</code> 仓库。</p>

<p>进入hugo创建的网站目录并设置 git 的远程地址：</p>

<pre><code class="language-bash">cd mysite
git remote add origin https://github.com/imroc/blog.git
</code></pre>

<p>将 <code>Github Pages</code> 的仓库下载到当前目录并命名 <code>public</code>：</p>

<pre><code class="language-bash">git clone https://github.com/imroc/imroc.github.io.git
mv imroc.github.io public
</code></pre>

<p>新增脚本 (<code>deploy.sh</code>):</p>

<pre><code class="language-bash">#! /bin/bash

set -eux 

echo -e &quot;\033[0;32mDeploying updates to GitHub...\033[0m&quot;

msg=&quot;rebuilding site `date`&quot;
if [ $# -eq 1  ]
    then msg=&quot;$1&quot;
fi

# Build the project. 
hugo # if using a theme, replace by `hugo -t &lt;yourtheme&gt;`

# Go To Public folder
cd public

# Add changes to git.
git add .

# Commit changes.
git commit -m &quot;$msg&quot;

# Push source and build repos.
git push origin master

# Come Back
cd ..

git add .
git commit -m &quot;$msg&quot;
git push origin master
</code></pre>

<p>这样执行脚本也可以更新网站，只不过分成了两个仓库，我也是用的这种做法，因为 <code>Github Pages</code> 主仓库只允许 master 分支作为网站内容，所以源文件就存在了另一个仓库 <code>blog</code></p>

<h2 id="自定义域名">自定义域名</h2>

<p>github 给我们提供了免费域名，但是我们还可以绑定自己的域名。</p>

<p>很简单，在仓库的 <code>Settings</code> 里的 <code>Github Pages</code> 部分，有个 <code>Custom domain</code> 的设置，将其设置为你需要绑定的域名（它会新建一个 commit，就是创建一个 <code>CNAME</code> 文件，内容是你填的域名），你也可以自己手动创建一个 CNAME 文件，效果是一样的。</p>

<p><strong>注：</strong> 由于自定义域名需要仓库里面有个 <code>CNAME</code> 文件，用上面的第二种方式（源文件与编译结果在不同仓库）管理的话，每次编译会覆盖 <code>public</code> 目录下除 <code>.git</code> 目录的文件，<code>CNAME</code> 文件可能就不在了，没关系，在源文件的 <code>static</code> 目录下放入 <code>CNAME</code> 文件即可保证每次编译的结果里面都会有 <code>CNAME</code> 文件。</p>

<p>下一步就是登录你的域名提供商的后台管理，设置DNS解析：</p>

<h3 id="绑定根域名">绑定根域名</h3>

<p>如果你想要绑定自己域名的根域名（如：<a href="imroc.io">imroc.io</a>），新建两个A记录，分别指向下面两个IP：</p>

<blockquote>
<p>192.30.252.153<br />
192.30.252.154</p>
</blockquote>

<h3 id="绑定二级域名">绑定二级域名</h3>

<p>如果你想要绑定自己域名的二级域名（如：<a href="blog.imroc.io">blog.imroc.io</a>），新建一个 <code>CNAME</code> 记录，值为你的 github 域名，如： <code>imroc.github.io</code></p>

<h2 id="自定义域名开启https">自定义域名开启https</h2>

<p>如果绑定了自定义域名，github pages 原则上是不能启用https的，但是可以借助 cloudflare</p>

<ul>
<li>在<a href="https://www.cloudflare.com/">cloudflare</a>上注册并获得 <code>nameserver</code></li>
<li>在域名注册机构的后台管理页面将  <code>nameservers</code> 设置为 <code>cloudflare</code> 上的（即让 <code>cloudflare</code> 来管理 dns）</li>
<li>确保 <code>Crypto</code>-<code>SSL</code> 为 <code>Full</code><br /></li>
</ul>

<p><img src="https://imroc.io/static/blog/hugo/cloudflare-crypto-full.png" /></p>

<ul>
<li>配置 Page Rules：加入一条规则，举例： <code>http://imroc.io/*</code> 设置为 <code>Always Use HTTPS</code><br />
<br /></li>
</ul>

<p><img src="https://imroc.io/static/blog/hugo/cloudflare-always-https.png" /></p>

<blockquote>
<p>最后等待一段时间生效</p>
</blockquote>

            </article>

            <ul class="pager blog-pager">
                
                <li class="previous">
                    <a href="https://imroc.io/posts/kubernetes/kubernetes-binaries/" data-toggle="tooltip" data-placement="top" title="Kubernetes程序二进制下载集合">&larr; Previous Post</a>
                </li>
                 
            </ul>
            
            <div>
                 
            </div>
            
            
            
            
<div>
    <section id="datecount">
        <h4 id="date"> Tue Jan 16, 2018</h4>
    </section>
    <h5 id="wc">2500 Words|Read in about 5 Min</h5>
    <h5 id="tags">Tags: 
        
        <a href="https://imroc.io/tags/hugo/">hugo</a> &nbsp;
    </h5>
</div>

            
            </div>
            
			
               <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
<aside id=comments>
    <div>
        <h2> Comments </h2>
    </div>
    <div id="container"></div>
    <link rel="stylesheet" href="https://imroc.io/static/gitment/default.css">
    <script src="https://imroc.io/static/gitment/gitment.browser.js"></script>
    <script>
        var gitment = new Gitment({
			owner: 'imroc', 
			repo: 'imroc.github.io', 
            oauth: {
				client_id: 'd05b8f959b3111c6fb63',
				client_secret: 'f30ef76ea0050ed731ace76f7fbf684ae5d28fbc',
            },
        })
        gitment.render('container')
    </script>
</aside>
</div>

			
        </div>
    </div>
    </section>
</div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
                <a href="mailto:roc@imroc.io" title="Email me">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://github.com/imroc" title="GitHub">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://twitter.com/imrocchan" title="Twitter">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
          <li>
            <a href="https://imroc.io/index.xml" title="RSS">
              <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x"></i>
                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
        </ul>
        <p class="credits copyright text-muted">
        &copy;2017
          
            
              <a href="imroc.io">roc</a>
                      
          
          
          
            &nbsp;&bull;&nbsp;
            <a href="https://imroc.io/">roc</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="http://gohugo.io">Hugo v0.31.1</a> powered &nbsp;&bull;&nbsp; Theme by <a href="http://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a> adapted to <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a>
          
        </p>
      </div>
    </div>
  </div>
</footer>

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://cdn.staticfile.org/photoswipe/4.1.2/photoswipe-ui-default.min.js"></script>
<script src="https://cdn.staticfile.org/photoswipe/4.1.2/photoswipe.js"></script>
<script src="https://imroc.io/js/auto-render.min.js"></script>
<script src="https://imroc.io/js/main.js"></script>
<script src="https://imroc.io/static/prism/prism.js"></script>
<script src="https://cdn.staticfile.org/KaTeX/0.7.1/katex.min.js"></script>
<script> renderMathInElement(document.body); </script>







  </body>
</html>

